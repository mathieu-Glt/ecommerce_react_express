withCredentials: true
est un paramÃ¨tre dâ€™axios (et de fetch) qui indique que les requÃªtes HTTP doivent inclure les cookies et les informations dâ€™authentification liÃ©es au domaine.

ğŸ”¹ Contexte
Cookies et sessions

Si ton serveur utilise express-session pour gÃ©rer les sessions utilisateur ou CSRF token basÃ© sur session, le cookie de session doit Ãªtre envoyÃ© avec chaque requÃªte.

Sans withCredentials: true, le navigateur nâ€™enverra pas les cookies sur les requÃªtes cross-origin (ex. frontend localhost:5173 vers backend localhost:8000).

CSRF

La protection CSRF de csurf stocke le token dans la session cÃ´tÃ© serveur, qui est associÃ©e Ã  un cookie.

Pour que le serveur puisse valider le token, le cookie de session doit Ãªtre prÃ©sent sur la requÃªte, donc withCredentials: true est nÃ©cessaire.

Cross-Origin Requests

Pour les requÃªtes cross-origin (CORS) :

Le serveur doit avoir credentials: true dans sa config CORS (app.use(cors({ credentials: true }))).

Le client doit avoir withCredentials: true.

Sinon, le navigateur bloque lâ€™envoi du cookie.